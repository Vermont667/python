1.С помощью объединения вывести данные о каждом заказчике, для которого определен продавец.

SELECT z.ID_Z, z.ID_Pr, z.SUMMA, z.Kol, z.DATA, z.CITY_Z, z.Cena_Dostavki 
FROM Zakaz z, Klient k
WHERE z.ID_KL=k.ID_KL



2.Вывести имя заказчика и данные о средней цене доставки для него. Если цена доставки больше средней по таблице написать - lot, меньше – few

SELECT k.Name_KL AS "Имя заказчика", AVG(z.Cena_Dostavki) AS "Средняя цена доставки", "few" AS "few / lot"
FROM Klient k INNER JOIN Zakaz z 
ON k.ID_KL = z.ID_KL
GROUP BY k.Name_KL
HAVING AVG(z.Cena_Dostavki) < 
   (SELECT AVG(Cena_Dostavki)
   FROM Zakaz)
UNION
SELECT k.Name_KL AS "Имя заказчика", AVG(z.Cena_Dostavki) AS "Средняя цена доставки", "lot"
FROM Klient k INNER JOIN Zakaz z 
ON k.ID_KL = z.ID_KL
GROUP BY k.Name_KL
HAVING AVG(z.Cena_Dostavki) > 
   (SELECT AVG(Cena_Dostavki)
  ?FROM Zakaz)

3.Соедините вместе все таблицы с помощью внешнего объединения.


SELECT *
FROM Zakaz z LEFT JOIN Klient k LEFT JOIN Prodaves p
GROUP BY z.ID_Z



4.С помощью объединения вывести данные о скидках клиента для каждого продавца

SELECT k.Name_KL, k.Discoun, p.Name_Pr
FROM Klient k INNER JOIN Prodaves p
WHERE k.ID_Pr=p.ID_Pr


5.Напишите запрос, который выведет все города, в которых живут продавцы и заказчики.

SELECT City_Pr
FROM Prodaves
UNION
SELECT City_KL
FROM Klient


6.С помощью объединения вывести все данные о заказчиках и заказах, даже если заказчик не сделал ни одного заказа за указанный период.

SELECT *
FROM Klient k INNER JOIN Zakaz z
ON k.ID_KL=z.ID_KL
ORDER BY k.ID_KL

7.Составьте запроса для вывода имен и кодов всех продавцов, в чьих городах есть покупатели, которых они не обслуживают. С помощью оператора в подзапросе.


SELECT p.Name_Pr, p.ID_Pr
FROM Prodaves p
WHERE EXISTS
   (SELECT k.ID_KL
   FROM Klient k
   WHERE p.City_Pr = k.City_KL AND NOT p.ID_Pr = k.ID_Pr)


8.Напишите запрос, который выведет все города и имена продавцов и заказчиков, которые живут в Лондоне.


SELECT City_Pr, Name_Pr
FROM Prodaves
WHERE City_Pr='London'
UNION
SELECT City_KL, Name_KL
FROM Klient
WHERE City_KL='London'